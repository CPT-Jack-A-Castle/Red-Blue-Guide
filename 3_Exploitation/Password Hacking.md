## Rainbow Tables

- Good for LM, NTLM and MD5 Hashes without Salt or Pepper
- Less CPU power, but more storage needed (!) 
   - NTLM hash with [uppercase, lowercase, numbers] and max length of 9 chars = 690GB of space (!)

## Lookups
- Query a database with hashes and passwords
- Easiest way to crack hashes
- Difference between Lookups and Rainbow Tables:
    - Data not stored on your system (no huge disk required)
    - DB contains well known wordlist and breach data (i/o every single combination)

## Pass the Hash (Hash Injection Attack)
- Use dumped hashes for Authen (password not required!)
- `pth-winexe -U [targetUser] //[IPv4] [command]`
- Best Case: User-Account-Control off, Windows Firewall off
- Helpful with LM, NTLM-Authen and SSO-mechanisms

## Wordlists
1. Kali: /usr/share/wordlists (pre-installed)
2. CLI tool **crunch**
   - `crunch 4 6 abcdefg123! -o crunchlist1.txt`
   - 4 6 = word length between 4 and 6
   - abcdefg123! = use chars out of this list
3. CLI tool **cewl**
   - custom wordlist generator based on website content
   - `cewl https://cisco.com -m 6 -d 3 -w cisco.cewl`
   - -m = minimum word length
   - -d = depth of sub directories
   - -w = write
4. [https://github.com/p-arrow/SecLists/tree/master/Passwords](https://github.com/p-arrow/SecLists/tree/master/Passwords)


## Tools

#### John the Ripper
- `john --wordlist=cisco.cewl --rules --stdout > crunchmutated.cewl`
- `nano /etc/john/john.conf`: configuration of wordlist-rules
- results are saved under .john/john.pot
   - No second run with same wordlist necessary, if a successful search already took place 
- `john --show [wordlist]`: show results 
- `john --list=formats`: show available hash formats recognized by john

#### Hydra

*Check out: [https://github.com/vanhauser-thc/thc-hydra](https://github.com/vanhauser-thc/thc-hydra)*

*Examples*

```
hydra -h ; hydra http-form-post -U (service module help)
hydra -l admin -P pw.txt "http-form-post://IPv4:80/login:username=^USER^&password=^PASS^:fail"
hydra -l user -P passlist.txt ftp://192.168.0.1
hydra -L userlist.txt -p defaultpw imap://192.168.0.1/PLAIN
hydra -C defaults.txt -6 pop3s://[2001:db8::1]:143/TLS:DIGEST-MD5
hydra -l admin -p password ftp://[192.168.0.0/24]/
hydra -L logins.txt -P pws.txt -M targets.txt ssh
```

#### Hashcat

*Check out: [https://hashcat.net/hashcat/](https://hashcat.net/hashcat/)*

*Example*

1. msf: `use post/windows/gather/hash` ("run" requires admin privilege)
2. Check for NT-Hash: `<Uname>:<User ID>:<LM hash>:<NT hash>:<Comment>:<Home Dir>:`
3. `hashcat -m 1000 -a 0 hash.txt /usr/share/john/password.lst`
    - `-m 1000` = hash-type NTLM
       - Other Types:
       - 900 = MD4
       - 0 = MD5
       - 100 = SHA1 
       - 3000 = LM
    - `-a 0` = attack-mode Straight
       - Other types: 
       - 1 = Combination
       - 3 = Brute-force


#### pwdump/FGDump
- Dump LM/NTLM-Hash via pwdump/FGDump:
    - pwdump-structure: `<Uname>:<User ID>:<LM hash>:<NT hash>:<Comment>:<Home Dir>:`
- LM Hash for "no password": 
    - "aad3b435b51404ee" "aad3b435b51404ee"
