***Buffer OVerflow**: When a process stores data outside the memory range allocated by the developer*

***Stack**: Reserved area of memory where program saves return address when function call received. With buffer overflow, the return pointer is overwritten with attackers code*

# Red Team

## Attacker Vectors
1. NOP + malicious code = "Smash the Stack"
2. C/C++ has no native boundary checking of buffer
3. Stack overflow is simpler than Heap overflow: C/C++ often use stack-based memory allocation techniques (!)

# BlueTeam

#### 1) ASLR (Address Space Layout Randomization)
- Introduced with Win XP SP3 (randomizes first two Bytes)
- Changes Base Address of loaded DLL/Stack/Heap after reboot
- Generally activated in Linux 
- Linux/CLI:
   - `echo 0 > /proc/sys/kernel/randomize_va_space` (deactivate)
   - `echo 1 > /proc/sys/kernel/randomize_va_space` (partly activate)
   - `echo 2 > /proc/sys/kernel/randomize_va_space` (activate)
   - Alternatively: `sysctl -a --pattern randomize kernel.randomize_va_space = 0/1/2`

#### 2) Stack Cookie/Stack Canary
- Placed between locale variables and RET-Befehl 
- System verifys if Canary has been destroyed due to Buffer Overflow
- Linux/Compiler: `gcc [...] -f no-stack-protector` (for deactivation)
- Windows/VisualStudio: `/GS` (activate via linker)

#### 3) SafeSEH
- Introduced with WinVS 2013
- Provides list of valid SEH-addresses
- Verifies validity of handler address before call 
- Windows/VisualStudio: `/SAFESEH` (activate via linker)

#### 4) SEHOP (SEH Overwrite Protection)
- Verify during runtime, whether OS Default Handler is available 
- Windows: `HKLM\SYSTEM\CurrentControlset\Control\Session Manager\kernel\DisableExceptionChainValidation`
   - (Activation: 0 / Deactivation: 1)

#### 5) DEP (Data Execution Prevention)
- Introduced with Windows XP SP3
- Generally activated in Linux
- Win/CLI: `bcdedit /set nx` (Choose between AlwaysOn/OptOut/OptIn/AlwaysOff)
- Linux/Compiler: `gcc [...] -z executestack` (for deactivation)

#### 6) Heap Spraying
- Modern Browser have diverse protection mechanisms implemented 
   1. Nozzle:
      - Detection of program code (because normally only data or addresses)
   2. Bubble:
      - Detection of returning memory areas
   3. EMET (Enhanced Mitigation Experience Toolkit):
      - Pre-Allocation of cyclic addresses (prevents access via Head Spraying)

#### 7) Static Code Analysis

#### 8) Java, Python and PHP can detect overflow conditions
