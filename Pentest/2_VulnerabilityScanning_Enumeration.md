# TABLE OF CONTENTS
1. [9 - ECHO](https://github.com/p-arrow/Red-Blue-Guide/blob/main/Pentest/2_VulnerabilityScanning_Enumeration.md#9---echo)
2. [13 - DAYTIME](https://github.com/p-arrow/Red-Blue-Guide/blob/main/Pentest/2_VulnerabilityScanning_Enumeration.md#13---daytime)
3. [17 - CHARGEN](https://github.com/p-arrow/Red-Blue-Guide/blob/main/Pentest/2_VulnerabilityScanning_Enumeration.md#17---chargen-tcpudp)
4. [19 - QUOTE OF THE DAY](https://github.com/p-arrow/Red-Blue-Guide/blob/main/Pentest/2_VulnerabilityScanning_Enumeration.md#19---quote-of-the-day-qotd)
5. [21 - FTP](https://github.com/p-arrow/Red-Blue-Guide/blob/main/Pentest/2_VulnerabilityScanning_Enumeration.md#21---ftp)
6. [22 - SSH](https://github.com/p-arrow/Red-Blue-Guide/blob/main/Pentest/2_VulnerabilityScanning_Enumeration.md#22---ssh)
7. [23 - TELNET](https://github.com/p-arrow/Red-Blue-Guide/blob/main/Pentest/2_VulnerabilityScanning_Enumeration.md#23---telnet-tcpudp)
8. [25,465,587 - SMTP](https://github.com/p-arrow/Red-Blue-Guide/blob/main/Pentest/2_VulnerabilityScanning_Enumeration.md#25465587---smtp-tcp)
9. [49 - TACACS+](https://github.com/p-arrow/Red-Blue-Guide/blob/main/Pentest/2_VulnerabilityScanning_Enumeration.md#49---tacacs+-tcp)
10. [53 - DNS](https://github.com/p-arrow/Red-Blue-Guide/blob/main/Pentest/2_VulnerabilityScanning_Enumeration.md#53---dns-tcpudp)
11. [67 - DHCP](https://github.com/p-arrow/Red-Blue-Guide/blob/main/Pentest/2_VulnerabilityScanning_Enumeration.md#67---dhcp-udp)
12. [69 - TFTP](https://github.com/p-arrow/Red-Blue-Guide/blob/main/Pentest/2_VulnerabilityScanning_Enumeration.md#69---tftp-udp)
13. [80,443 - HTTP(S)](https://github.com/p-arrow/Red-Blue-Guide/blob/main/Pentest/2_VulnerabilityScanning_Enumeration.md#80443---https)
14. [88 - KERBEROS](https://github.com/p-arrow/Red-Blue-Guide/blob/main/Pentest/2_VulnerabilityScanning_Enumeration.md#88---kerberos-tcpudp)
15. [110,995 - POP3](https://github.com/p-arrow/Red-Blue-Guide/blob/main/Pentest/2_VulnerabilityScanning_Enumeration.md#110995---pop3)
16. [111 - RPCBIND](https://github.com/p-arrow/Red-Blue-Guide/blob/main/Pentest/2_VulnerabilityScanning_Enumeration.md#111---rpcbind)
17. [119 - NNTP](https://github.com/p-arrow/Red-Blue-Guide/blob/main/Pentest/2_VulnerabilityScanning_Enumeration.md#119---nntp-tcp)
18. [123 - NTP](https://github.com/p-arrow/Red-Blue-Guide/blob/main/Pentest/2_VulnerabilityScanning_Enumeration.md#123---ntp-udp)
19. [135 - RPC](https://github.com/p-arrow/Red-Blue-Guide/blob/main/Pentest/2_VulnerabilityScanning_Enumeration.md#135---rpc)
20. [137,138,139 - NetBIOS](https://github.com/p-arrow/Red-Blue-Guide/blob/main/Pentest/2_VulnerabilityScanning_Enumeration.md#137138139---netbios-tcpudp)
21. [143,993 - IMAP](https://github.com/p-arrow/Red-Blue-Guide/blob/main/Pentest/2_VulnerabilityScanning_Enumeration.md#143---imap-tcp)
22. [161,162 - SNMP, SNMPTRAP](https://github.com/p-arrow/Red-Blue-Guide/blob/main/Pentest/2_VulnerabilityScanning_Enumeration.md#161162---snmp,snmptrap-typically-udpalso-tcp)
23. [445 - SMB, CIFS](https://github.com/p-arrow/Red-Blue-Guide/blob/main/Pentest/2_VulnerabilityScanning_Enumeration.md#445---smb,cifs-tcp)
24. [389,636 - LDAP](https://github.com/p-arrow/Red-Blue-Guide/blob/main/Pentest/2_VulnerabilityScanning_Enumeration.md#389636---ldap-tcpudp-ftp)
25. [500 - ISAKMP](https://github.com/p-arrow/Red-Blue-Guide/blob/main/Pentest/2_VulnerabilityScanning_Enumeration.md#500---isakmp-udp)
26. [513 - RLOGIN](https://github.com/p-arrow/Red-Blue-Guide/blob/main/Pentest/2_VulnerabilityScanning_Enumeration.md#513---rlogin-tcp)
27. [514,6514 - SYSLOG](https://github.com/p-arrow/Red-Blue-Guide/blob/main/Pentest/2_VulnerabilityScanning_Enumeration.md#5146514---syslog-udptcptls)
28. [1433 - MS-SQL](https://github.com/p-arrow/Red-Blue-Guide/blob/main/Pentest/2_VulnerabilityScanning_Enumeration.md#1433---mssql-tcp)
29. [3306 - MYSQL](https://github.com/p-arrow/Red-Blue-Guide/blob/main/Pentest/2_VulnerabilityScanning_Enumeration.md#3306---mysql-tcp)
30. [3389 - RDP](https://github.com/p-arrow/Red-Blue-Guide/blob/main/Pentest/2_VulnerabilityScanning_Enumeration.md#3389---rdp-tcpudp)
31. [5900 - VNC](https://github.com/p-arrow/Red-Blue-Guide/blob/main/Pentest/2_VulnerabilityScanning_Enumeration.md#5900---vnc-tcp)
32. [5985,5986 - WinRM](https://github.com/p-arrow/Red-Blue-Guide/blob/main/Pentest/2_VulnerabilityScanning_Enumeration.md#59855986---winrm-httphttps)
33. [FARADAY](https://github.com/p-arrow/Red-Blue-Guide/blob/main/Pentest/2_VulnerabilityScanning_Enumeration.md#faraday)
34. [MANUAL VS AUTOMATIC SCANNING](https://github.com/p-arrow/Red-Blue-Guide/blob/main/Pentest/2_VulnerabilityScanning_Enumeration.md#manual-vs-automatic-scanning)
35. [VULNERABILITY MANAGEMENT](https://github.com/p-arrow/Red-Blue-Guide/blob/main/Pentest/2_VulnerabilityScanning_Enumeration.md#vulnerability-management)

<br />

# 9 - ECHO
## Info
- Vulnerable to DDoS

<br />

# 13 - DAYTIME
## Info
- Vulnerbale to DDoS

<br />

# 17 - CHARGEN (TCP/UDP)
## Info
- CHARGEN = Character Generator Protocol
- Vulnerable to DDoS
- Not enabled by default
- UDP request urge random UDP reply between 0 and 512 bytes (!)

## HowTo
- Example: `telnet IPv4 chargen`
- Enabling Chargen under `/etc/inetd.conf`

<br />

# 19 - QUOTE OF THE DAY (QOTD)
## Info
- Vulnerable to DDoS
- Exp: telnet [IPv4] 17 --> returns quote
- Amplification factor: 140
- Disable/Enable: /etc/inetd.conf

<br />

# 21 - FTP
## Info
- FTPS (TSL for Encryption)
- Port 20: Communication
- Port 21: File Transfer


<br />

# 22 - SSH
## Info
- SFTP(FTP over SSH)

<br />

# 23 - TELNET (TCP/UDP)

<br />

# 25,465,587 - SMTP (TCP)
## Info
- ESMTP (Extended SMTP): Authentifizierung + Zustellung an mehrere Empf√§nger

<br />

# 49 - TACACS+ (TCP)

<br />

# 53 - DNS (TCP/UDP)

<br />

# 67 - DHCP (UDP)

<br />

# 69 - TFTP (UDP)
## Info
- Trivial File Transfer Protocol
- Booting OS from LAN file server
- Client/Server application
- Sacrifies reliability for efficiency (UDP)

<br />

# 80,443 - HTTP(S)

<br />

# 88 - KERBEROS (TCP/UDP)

<br />

# 110,995 - POP3
## Info
- Post Office Protocol

<br />

# 111 - RPCBIND
## Info
- Maps RPC services to port numbers in UNIX-like environment

<br />

# 119 - NNTP (TCP)
## Info
- Network News Transfer Protocol
- Used to transport Usenet articles

<br />

# 123 - NTP (UDP)
## Info
- Network Time Protocol

<br />
# 135 593 - MSRPC (TCP/UDP)
## Info
- Remote Procedure Call
- Used to locate DCOM ports to request service from a program on another PC on the network

<br />

# 137,138,139 - NetBIOS (TCP/UDP)
## Info
- NetBIOS over TCP/IP (NBT)
- NetBIOS Name Service 137/udp
- NetBIOS Datagram Service 138/udp
- NetBIOS Session Service 139/tcp (Host2Host Verbindung, SMB)
- NetBIOS-Namen:
   - Always 16 chars long
   - 16th char is suffix for service 

<br />

# 143,993 - IMAP (TCP)
## Info
- Internet Mail Application Protocol

<br />

# 161,162 - SNMP,SNMPTRAP (typically UDP/also TCP)

<br />

# 445 - SMB/CIFS (TCP)
## Info
- Like Samba for Linux
- File Sharing Service 
- UNC-Pfad (Uniform Name Convention): \\Server address\Ressource
- Common Internet File System (CIFS) is evolution of SMB
   - New Feature: Remote Procedure Call (RPC) over 135/udp+tcp
   - CIFS communicates over own port 445/tcp (i/o NBT)
- SMB 1.0 is one of the biggest Vulnerability (~30 years old) and deactivated by default (!)

<br />

# 389,636 - LDAP (TCP/UDP)
## Info
- Vendor-Neutral Standard
- For accessing/manipulating distributed directory
- Based on Client-Server-Modell
- Distinguished Name (DN) = eindeutiges Objekt in LDAP
- Common Name (CN)
- Domain Component (DC)
- knowledge about User (without root) is enough to gather information 

<br />

# 500 - ISAKMP (UDP)
## Info
- ISAKMP = Internet Security Association and Key Management
- Used to set up IPsec tunnels

<br />

# 513 - Rlogin (TCP)
## Info
- Remote Login Service

<br />

# 514,6514 - Syslog (UDP)(TCP/TLS)
## Info
- To conduct computer message logging
- Especially concerning routers and firewalls

<br />

# 1433 - MS-SQL (TCP)
## Info
- Receive SQL DB queries from clients

<br />

# 3306 - MySQL (TCP)

<br />

# 3389 - RDP (TCP/UDP)
## Info
- Remote Desktop Protocol
- Remote connection via GUI (MS Proprietary)

<br />

# 5900 - VNC (TCP)
## Info
- Virtual Network Computing
- Cross-platform version of RDP
- Requires client/server/protocol to be configured
- Should only be used for internal network (!) --> for external NWs VPN is preferred

<br />

# 5985,5986 - WinRM (HTTP/HTTPS)
## Info
- Windows Remote Management
- In Windows integrated remote management protocol 
- Uses SOAP (Simple Object Access Protokoll) for connection setup 

<br />

# FARADAY
## Info
- Kali Pentesting IDE

## HowTo
### Import Reports
1. CLI: `faraday-client --login`
2. Enter username and pw
3. Create Workspace
4. Import Report

### Tracking with Faraday
1. Create new workspace every quarter and compare over time
2. To understand how your organization is evolving and improving

### Prioritization & Response Phase I (Create)
1. Add hosts, credentials and vulnerabilities after vuln scanning

![grafik](https://user-images.githubusercontent.com/84674087/131910514-b1007c5f-b622-41b7-bcd6-7b99b7d6613d.png)

### Prioritization & Response Phase II (Manage) 
1. Risk Rating (Low, Medium, High)
2. Confirmation of Vulns
3. Determine effort needed for fixing
4. Set up action plan: retest, close vulns or accept risk

![grafik](https://user-images.githubusercontent.com/84674087/131910482-02a20f5f-991b-4cf8-9a52-bc7fcf416ee3.png)

<br />

# MANUAL VS AUTOMATIC SCANNING
## Info
### Automated Scanning
**Advantages**
1) Fast
2) Low cost
3) Quick overview of target system 
4) Flexible (easy to scale up/down) 

**Disadvantages**
1) Noisy (recognized by IDS/IPS/SIEM)
2) Results may be unprecise (False Positives, False Negatives)
3) Target system stability may get affected (extra NW traffic, new log file entries)
4) No Social Engineering
5) No Pivot-Attack capture

### Manual Scanning
**Advantages**
1) In-depth approach for each host 
2) Allows intelligent searching of sensitive data
3) Can eliminate false positives

**Disadvantages**
1) Longer length of testing
2) Often a more limited scope in terms of  number of systems tested
3) More costly
4) Increased time in getting final deliverable

<br />

# VULNERABILITY MANAGEMENT
## Info
### Preparation
- Scan -> Patch -> Scan (ideally weekly)
- FW/IDS/IPS need exceptions to allow vuln scanners to operate
- Embedded systems can react unpredictable upon Vuln Scanners
- Vuln scans should include both physical and virtual hosts
- Create dedicated account for scanning purpose (i/o admin account)

### VulnScan Software (commercial)

*Requires ongoing paid subscription to access vuln feeds for new vuln signatures*

1. Nessus
2. Qualysguard (cloud based)
3. AlienVault
4. Saint
5. Burp
6. etc.

### Scan types
1. Passive (most stealth, w/o sending probes)
2. Active (consumes bandwidth/ processor resources)
3. Credentialed (discover more vulns)
4. Non-Credentialed
5. Server-based
6. Host-based (less impact on network, less service outages)
7. Internal scan (more insight) vs. External (attacker's perspective)

### Sensitivity
1. Discovery
2. Fast/Basic Assessment
3. Full/Deep Assessment
4. Compliance

### Process Flow
1. Define desired state of security/ scanning-scope/scan sensitivity
2. Create a baseline
3. Prioritize the vulnerabilities
4. Mitigate vulnerabilities
5. Monitor/Retest the network

### Common Identifiers
- CVE (Common Vulnerabilty and Exposure)
- NVD (National Vulnerability Database)
- CAPEC (Common Attack Pattern Enumeration and Classification): maintained by MITRE
- CPE (Common Platform Enumeration)
- CCE (Common Configuration Enumeration)
