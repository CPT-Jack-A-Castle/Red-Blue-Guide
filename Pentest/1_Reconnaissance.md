# TABLE OF CONTENTS
1. [PERSON](https://github.com/p-arrow/Red-Blue-Guide/blob/main/Pentest/1_Reconnaissance.md#person)
2. [ORGANIZATION](https://github.com/p-arrow/Red-Blue-Guide/blob/main/Pentest/1_Reconnaissance.md#organization)
3. [SOCIAL ENGINEERING](https://github.com/p-arrow/Red-Blue-Guide/blob/main/Pentest/1_Reconnaissance.md#social-engineering)

# PERSON
- **General Search**
   - [Google](https://www.google.com), [Bing](https://www.bing.com), [Yahoo](https://www.yahoo.com), [Baidu](https://www.baidu.com), [Startpage](https://www.startpage.com), [Internet Archive](https://archive.org/web/)
   - Put **quotation marks** around the name you are searching
- **Google Hacking**: To improve and streamline your google search
   - `site:example.com searchTerm`: "searchTerm" may be included in text, url, title  etc.
   - `allintext: searchTerm`
   - `site:example.com inurl:ipv6`
   - `inurl:example.com ext:pdf`
   - `searchTerm filetype: png`
   - `site:example.com intitle:tools`
   - `info:example.com`
   - `cache:example.com`: show cached results
   - `related:example.com`
   - `info:example.com -contact`: Use "-" in front of word/quote to exclude that string
   - [Google Hacking DB](https://www.exploit-db.com/google-hacking-database): contains predefined search operators
- **Online People Finder**
- **Email**
   - Verify any data breach related to an Email address found - with [HaveIbeenPwned](https://haveibeenpwned.com/) 
- **Phone Number**
   - [Sundowndev/Phoneinfoga](https://sundowndev.github.io/phoneinfoga/install/)
   - `phoneinfoga scan -n "+33 06 79368229"`: Example
- **Social Media**
   - Look at [Facebook](https://www.facebook.com), [Twitter](https://twitter.com/), [Instagram](https://www.instagram.com/) and [LinkedIn](https://www.linkedin.com/)
   - You have to create anonymous accounts to enable any search functions
   - Shortcut for getting an overview about person's social media footprint: [Sherlock](https://github.com/sherlock-project/sherlock)
   - Simply type: `sherlock username`
   - **Instagram**
   - Checkout [Osintgram](https://github.com/Datalux/Osintgram) - own (dummy) Insta Account needed!
   - `python3 main.py <target username>`: Kickoff
- **News**
   - Go to [Google](https://www.google.com), enter the person's name, switch to "News" and refine the filter:
      - Change the time period
      - Sort by time or relevance 
- **OSINT**
   - [OSINT Framework](https://osintframework.com/)
- **Build Links & Analysis**
   - Put all data gathered together in a **visual tool** like [Maltego](https://www.maltego.com/), [Cherrytree](https://github.com/giuspen/cherrytree), [Xmind](https://www.xmind.net/) or any other editor your prefer
   - **Discover** unintentional information leakage
   - **Create** new information and develop conclusions

<br />

# ORGANIZATION
- **Domain Names** (public, private and associated):
    - **WHOIS**: The WHOIS command is a great source of data for fetching domain- and IP-related information
    - **Dig**: Find current data about DNS records
    - **Sublist3r**: This is one of the best subdomain enumeration tools around
    - **Th3inspector**: This infosec utility will enable you to fetch all kinds of website-related information
- **Open ports & Network hosts & TCP/UDP running services**
    - **Nmap**:
       - Check out: [https://nmap.org/book/man-briefoptions.html](https://nmap.org/book/man-briefoptions.html)
       - **Directories**
         - `/usr/share/nmap/nmap_payloads`: Which packets are sent during scan 
         - `/usr/share/nmap/nmap_services`: port list with indicated chance of being "open" 
         - `/usr/share/nmap/scripts`: Script list
       - **Common Scans**
         - `nmap -sn 192.168.12.0/24`: Only Host Discovery (alternatively with `-sP`)
         - `nmap -sV -O -Pn IPv4`: Show version and OS of IPv4 (w/o Host Discovery/Ping), cover 1000 TCP ports
         - `nmap -p21,23,80 -reason`: scan explicit ports and show short explanation of host answer
         - `nmap -p- -v -6`: scan all 65k ports verbosely with IPv6 only
         - `nmap -Pn -p- -sI [IPv4 Zombie] [IPv4 target]`: TCP-IDLE Scan via Zombie Host --> investigate via IP-ID if port is open/closed
         - `nmap -PU80,443`: UDP-Scan + explicit port selection
         - `nmap -sA -sT IPv4`: ACK Packet (FW Walking possible!) and TCP-Scan (when -sS is no option due to missing raw socket access, i.e. no root access)
       - **Quick Scans**
         - `nmap -F`: 100 Ports
         - `nmap --top-ports 10`: 10 top Ports scannen
         - `nmap --exclude-ports [Portnr, Portnr, ...]`
         - `nmap -sS -sU -p T:22,25,80,U:53,161 [IPv4]`
         - `nmap -T`: Scan time T0 [paranoid] - T5[insane] (Fast Speed can cause fragile devices to reboot/print random data !)
      - **Scanflags**:
         -  `nmap --scanflags [your own flag]`
         - `-sN`: TCP Null (no flag) | `-sF`: FIN | `-sX`: Xmas (FIN, PSH, URG)
      - **NSE (Nmap Script Engine)**
         - Extended analysis of target system with scripts written in LUA script language 
         - NSE-Scripts verify host & service BEFORE execution (efficient)
         - `nmap -sC IPv4`: -sC = --script=default
         - `nmap --script http-waf-detect [IPv4]`
         - `nmap --script HTTP-google-malware [IPv4]`: query if IP is in Google DB
         - `nmap -sV --script=vuln [IPv4]`
         - `nmap -sV -p 22 --script ssh2-enum-algos [IPv4]`
         - `nmap --script-help "*ms* and *sql*"`
         - `nmap --script=rdp* -p3389 -T4 IPv4`: Get Domain Name and NetBIOS computer name information
      - **Firewall Evasion** (If nmap is blocked):
         - ICMP Echo Request (Typ 8): `nmap -PE`
         - ICMP Timestamp Request (Typ 13): `nmap -PP`
         - TCP SYN Port 443:`nmap -PS443`
         - TCP ACK Port 80: `nmap -PA80`
      - **Firewall Avoidance**
         - Fragmentation of sent packets: `nmap -f [IPv4] --top-ports 10`
         - Decoy Scan: `nmap -D [fakeIPv4],...,...,ownIP] [target IPv4]`
            - Place your own IP at sixth place
            - Some IDS don't show IPv4 anymore after several recognized port scans 
         - Usage of alternative sender address: `nmap -S [fakeIPv4]` (at the expense of missing scan results)
         - SYN-Stealth-Scanning: Not stealthy anymore (!)
       - **TTL Reply**
         - The output of a successful ping contains information about TTL (Time to Live)
         - `TTL 128`: Normally Windows machine
         - `TTL 64`: Normally Linux machine
    - **Recon-ng**:
       - A framework that performs automatic reconnaissance for you!
       - Example **cisco.com**
      ```
      workspaces create cisco.com 
      marketplace info [module] / marketplace install [module]
      modules load [module]: info / options set [Name]
      db insert domains cisco.com
      ```
       - Example Modules:
       - `run google_site_web`: show hosts
       - `run recon/hosts-hosts/resolve`: resolve IPv4 hosts
       - `keys add ipinfodb <API key>` + `modules load recon/hosts-hosts/ipinfodb` -> check IP location of target
         - register yourself to receive API keys
      - `Module pocs`: investigate Email addresses 
      - `Module reporting/html`: create report
- **Public and private IP blocks**
- **Routing tables**
   - **Traceroute**: As one of the most popular network tools used to track the path of networks packets 
- **SSL certificates**
- **User enumeration**
- **OS hostnames & OS System Type** (fingerprinting)
- **System banners**
- **Corporate Emails**:
   - Standard for ARPA (**A**dvanced **R**esearch **P**rojects **A**gency) Text Messages: [RFC 822](https://www.w3.org/Protocols/rfc822/)
   - Email Parsing: [https://www.parsemail.org/](https://www.parsemail.org/)
- **Organization's (I)IoT**
   - **Shodan**: Search filters at [shodan](https://www.shodan.io/):
   ```
   country:DE
   city:stuttgart
   hostname:siemens
   net:88.287.456.34
   net:88.287.456.0/24
   netgear port:23
   os:windows
   title: wireless
   ```
   - **CLI Commands**
   - Installation instructions: [shodan CLI](https://cli.shodan.io/)
   ```
   shodan myip
   shodan host [IPv4]
   shodan count microsoft iis 6.0
   shodan download new-microsoft-data microsoft iis 6.0
   shodan search --limit 10 --fields ip_str,port,org,hostnames microsoft iis 6.0
   shodan parse --fields ip_str,port,org --separator , microsoft-data.json.gz
   shodan stats telnet
   shodan stats --facets ssl.cert.fingerprint has_ssl:true
   shodan stats --facets isp net:0/0 (Alt: isp country:DE)
   shodan stats --facets vuln.verified country:DE
   ```

<br />

# SOCIAL ENGINEERING
## Techniques
- **Smishing**: Phishing over SMS
- **Vishing**: Phishing over VoIP
- **Whaling**: Spear Phishing targeting CEOs, CFOs, COOs etc.
- **Diversion Theft**: Redirect a delivery
- **Hoax**
- **Shoulder surfing**
- **Eavesdropping**
- **Dumpster Diving**: Digging in a organization's garbage
- **Baiting**: Leave a malicious USB stick/CD somewhere randomly
- **Piggybacking/Tailgating**: Enter restricted area by following closely behind another person without the person knowledge
- **Watering Hole**: Spoof website that people visit often
- **Identity Fraud**: Take credit card/social number etc and misuse it
- **Identity Theft**: Imitate User ID, conduct malicious action

## Effective Social Engineering Approaches
1. "Your account has been locked"
2. "We need your personal email"
3. "The client needs credentials right now"
4. "Confirm your information in this PDF"
5. "There is troubling information in your performance report"

## Rules for Social Engineering
1. Don't use messaging related to the target's personal life
2. Don't make promises to the target or raises false hopes
3. Don't embarrass the target

## Phishing Campaign
1. **Configure the sending profile**
    - The email address we want to send the phishing emails from
2. **Import users** 
    - Divide users into groups based on job / department
    - Send different campaigns to different groups or at different times
3. **Build a landing page**
    - website where targets land if they click link in email
    - It is very easy to clone existing websites
    - Popular social media login pages often cloned for phishing
4. **Create an email**
    - The most important part of the process
    - Requires extensive research and analysis of the users
5. **Organize into a Campaign**
    - Set the time when users will get the email
    - Use dashboard (opened emails / clicks / submitted data)
