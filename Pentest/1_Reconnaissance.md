# TABLE OF CONTENTS
1. [PERSON](https://github.com/p-arrow/Red-Blue-Guide/blob/main/Pentest/1_Reconnaissance.md#person)
2. [ORGANIZATION](https://github.com/p-arrow/Red-Blue-Guide/blob/main/Pentest/1_Reconnaissance.md#organization)
3. [SERVICE](https://github.com/p-arrow/Red-Blue-Guide/blob/main/Pentest/1_Reconnaissance.md#service)

# PERSON
## Info

![grafik](https://user-images.githubusercontent.com/84674087/131572347-89aa91c5-69a4-418c-b46a-8d62049bde82.png)

## HowTo
### Mining
1. General Search
   - [Google](https://www.google.com), [Bing](https://www.bing.com), [Yahoo](https://www.yahoo.com): Put quotation marks around the name you are searching
2. Online People Finder
3. Social Media
   - Look at [Facebook](https://www.facebook.com), [Twitter](https://twitter.com/), [Instagram](https://www.instagram.com/) and [LinkedIn](https://www.linkedin.com/)
   - You have to create anonymous accounts to enable any search functions
4. News
   - Go to [Google](https://www.google.com), enter the person's name, switch to "News" and refine the filter:
      - Change the time period
      - Sort by time or relevance 
5. OSINT
   - [OSINT Framework](https://osintframework.com/)

### Build Links
1. Put all data gathered together in a visual tool like [Maltego](https://www.maltego.com/), [Cherrytree](https://github.com/giuspen/cherrytree), [Xmind](https://www.xmind.net/) or any other editor your prefer

### Analysis
1. Discover unintentional information leakage
2. Create new information and develop conclusions

<br />

# ORGANIZATION

<br />

# SERVICE

1. [ARP](https://github.com/p-arrow/Red-Blue-Guide/blob/main/Pentest/1_Reconnaissance.md#arp)
2. [EXPLORATORY LINK ANALYSIS](https://github.com/p-arrow/Red-Blue-Guide/blob/main/Pentest/1_Reconnaissance.md#exploratory-link-analysis)
3. [E-MAIL](https://github.com/p-arrow/Red-Blue-Guide/blob/main/Pentest/1_Reconnaissance.md#e-mail)
4. [GOOGLE HACKING](https://github.com/p-arrow/Red-Blue-Guide/blob/main/Pentest/1_Reconnaissance.md#google-hacking)
5. [NMAP](https://github.com/p-arrow/Red-Blue-Guide/blob/main/Pentest/1_Reconnaissance.md#nmap)
6. [OFFENSIVE OSINT](https://github.com/p-arrow/Red-Blue-Guide/blob/main/Pentest/1_Reconnaissance.md#offensive-osint)
7. [RECON_NG](https://github.com/p-arrow/Red-Blue-Guide/blob/main/Pentest/1_Reconnaissance.md#recon_ng)
8. [SHODAN](https://github.com/p-arrow/Red-Blue-Guide/blob/main/Pentest/1_Reconnaissance.md#shodan)
9. [WEB APPLICATION](https://github.com/p-arrow/Red-Blue-Guide/blob/main/Pentest/1_Reconnaissance.md#web-application)

# ARP
## Info
*ARP = Address Resolution Protocol*

**ARP Attacks**
- Exploit IP-to-MAC resolution to steal/modify/redirect frames
- Allows MITM/DoS attacks

## HowTo
### ARP Scans
- Kali: `$ arp-scan --localnet`
- Windows: `arp -a` (show all arp-cache)

<br />



<br /> 

# E-MAIL
## Info
- Standard for ARPA (**A**dvanced **R**esearch **P**rojects **A**gency) Text Messages: [RFC 822](https://www.w3.org/Protocols/rfc822/)
- Email Parsing: [https://www.parsemail.org/](https://www.parsemail.org/)

<br />

# GOOGLE HACKING
## Info
- Use Google Hacking to improve and streamline your google search

## HowTo
```
site:example.com searchTerm ("searchTerm" may be included in text, url, title  etc.)
allintext: searchTerm
site:example.com inurl:ipv6
inurl:example.com ext:pdf
site:example.com intitle:tools
info:example.com
cache:example.com
related:example.com
info:example.com -contact (Use "-" in front of word/quote to exclude that string)
```

### URL Modifier
- Is added to result page for filtering

Code | Meaning
---- | -------
pws = 0 | dont give personalized results
ilter = 0 | don't use filters
tbs = li:1 | don't auto correct my search term

<br /> 

# NMAP
## Info
Check out: [https://nmap.org/book/man-briefoptions.html](https://nmap.org/book/man-briefoptions.html)

## HowTo
### Common Commands
- `nmap` (scans 1,000 TCP ports on the target)
- `nmap -sn / -sP`  (only Host Discovery)
- `nmap -Pn` (no Host Discovery/Ping, only port scan)
- `nmap -p21,23,80` (explicit port selection)
- `nmap -p-` (all 65k ports)
- `nmap -v` (verbose)
- `nmap -6` (IPv6)
- `nmap -reason` (short explanation of host answer)
- `nmap -sI` (TCP-IDLE Scan via Zombie Host) --> investigate via IP-ID if port is open/closed
- `nmap -Pn -p- -sI [IPv4 Zombie] [IPv4 target]`
- `nmap -PU80,443` (UDP-Scan + explicit port selection)
- `nmap -PE` (ICMP type 8 = echo request)
- `nmap -PP` (ICMP type 14 = timestamp 
- `nmap -PM` (ICMP type 18 = address mask)
- `nmap -sA`  (ACK Paket (FW Walking possible!))
- `nmap -sV`  (Version identification)
- `nmap -sS` (SYN scan)
- `nmap -sU` (UDP scan)
- `nmap -sT`  (TCP scan) --> when -sS is no option due to missing raw socket access, i.e. no root access
- `nmap -O` (OS identification )
- `nmap -oX` (Output .xml; add "--webxml" as stylesheet reference)
- `nmap -T` (Scan time T0 [paranoid] - T5[insane])
    - **> Fast Speed can cause fragile devices to reboot/print random data (!)**


### NSE (Nmap Script Engine)
- Written in LUA script language
- Extended analysis of target system 
- Testing for vulns of certain exploits 
- NSE-Scripts verify host & service before execution (efficient) --> only suitable scripts are executed
- Scripts are stored here: `/usr/share/nmap/scripts`

**NSE Examples:**
```
- nmap -sC [IPv4] (-sC = --script=default)
- nmap --script [script1],[script2],... [IPv4] (explicit script selection)
- nmap --script http-waf-detect [IPv4]
- nmap --script HTTP-google-malware [IPv4] (query if IP is in Google DB)
- nmap localhost -p 31000-32000 -sV
- nmap -sV --script=vuln [IPv4]
- nmap -sV -p 22 --script ssh2-enum-algos [IPv4]
- nmap --script-help "*ms* and *sql*"
```

### Quick Scans
1. `nmap -F`: 100 Ports
2. `nmap --top-ports 10`: 10 top Ports scannen
3. `nmap --exclude-ports [Portnr, Portnr, ...]`
4. `nmap -sS -sU -p T:22,25,80,U:53,161 [IPv4]`

### Scanflags
- `nmap --scanflags [your own flag]`: 
    - sN: TCP Null (no flag)
    - sF: FIN
    - sX: Xmas (FIN, PSH, URG)

### Important Directories
- `/usr/share/nmap/nmap_payloads`: Which packets are sent during scan 
- `/usr/share/nmap/nmap_services`: port list with indicated chance of being "open" 
- `/usr/share/nmap/scripts`: Script list

### Firewall Evasion (If nmap is blocked)
1. ICMP Echo Request (Typ 8): `nmap -PE`
2. ICMP Timestamp Request (Typ 13): `nmap -PP`
3. TCP SYN Port 443:`nmap -PS443`
4. TCP ACK Port 80: `nmap -PA80`

### Firewall Avoidance
1. Fragmentation of sent packets: `nmap -f [IPv4] --top-ports 10`
2. Decoy Scan: `nmap -D [fakeIPv4],...,...,ownIP] [target IPv4]`
   - Place your own IP at sixth place
   - Some IDS don't show IPv4 anymore after several recognized port scans 
3. Usage of alternative sender address: `nmap -S [fakeIPv4]`
   - Only deception (at the expense of missing scan results)
4. SYN-Stealth-Scanning: Not stealthy anymore (!)

### TTL Reply
The output of a successful ping contains information about TTL (Time to Live)
- TTL 128: Normally Windows machine
- TTL 64: Normally Linux machine

![grafik](https://user-images.githubusercontent.com/84674087/133131598-45427a85-9b92-4221-af39-0e95bbcab638.png)


<br />


<br />

# OFFENSIVE OSINT
## Info
*Going after hackers and uncover their identities* (when organization is under attack)

### Best Practices
1) Out-of-band communication: Avoid regular communication channels
2) Fake social media profiles
3) Passive info gathering: Avoid tools that send your IP addr to target
4) Need-to-know: Do not tell anyone about analysis except IRT

<br />

# RECON_NG
## Info
- A framework that performs automatic reconnaissance for you!

## HowTo
### Example cisco.com
```
workspaces create cisco.com 
marketplace info [module] / marketplace install [module]
modules load [module]: info / options set [Name]
db insert domains cisco.com
```

### Example Modules
1) run google_site_web: show hosts
2) run recon/hosts-hosts/resolve: resolve IPv4 hosts
3) keys add ipinfodb <API key> ; modules load recon/hosts-hosts/ipinfodb
    - check IP location of target
    - register yourself to receive API keys
4) Module pocs: investigate Email addresses
5) Module reporting/html: create report
  
<br />

# SHODAN
## HowTo
### Example: Search filters at [shodan](https://www.shodan.io/)
```
country:DE
city:stuttgart
hostname:siemens
net:88.287.456.34
net:88.287.456.0/24
netgear port:23
os:windows
title: wireless
```
   
### Example: CLI Commands
- Installation instructions: [shodan CLI](https://cli.shodan.io/)
```
shodan myip
shodan host [IPv4]
shodan count microsoft iis 6.0
shodan download new-microsoft-data microsoft iis 6.0
shodan search --limit 10 --fields ip_str,port,org,hostnames microsoft iis 6.0
shodan parse --fields ip_str,port,org --separator , microsoft-data.json.gz
shodan stats telnet
shodan stats --facets ssl.cert.fingerprint has_ssl:true
shodan stats --facets isp net:0/0 (Alt: isp country:DE)
shodan stats --facets vuln.verified country:DE
```

<br />
   
# WEB APPLICATION
## Info
- Credits to [Carlospolop](https://github.com/carlospolop/hacktricks/tree/master/pentesting)
1. Take a "notebook" to keep track of all your findings (e.g. [Cherrytree](https://github.com/giuspen/cherrytree) or [Mind Map](https://www.xmind.net/)
2. Identify the **technologies** used by the web server
3. Initial checks:
   - robots (www.example.com/robots.txt): allow/disallow search of web crawlers
   - sitemap
   - 404/500 errors
   - SSL/TLS scan (if HTTPS)
   - Different extensions: home.html / home.asp / home.aspx / home.php
   - Metadata of pictures with exiftool
   - Spider the web page in order to find all possible files, folders and parameters (iterative process!)
   - Directory/Parameter Brute-Forcing**: To enumerate even more files, directories and hidden parameters
   - Look out for backups of discovered files appending common backup extensions
4. Once you have identified all the possible endpoints accepting user input, check for all kind of vulnerabilities related to it!

<br />
   
## HowTo 
### curl
```
curl example.com
curl --head example.com
curl -X GET example.com 
curl -X DELETE example.com/include/config.db
curl -X OPTIONS example.com --head (show available HTTP Methods)
curl -T file example.com 
curl -O example.com/file 
curl -u username:password http://
```
- `-X` = --request
- `-T` = upload file
- `-O` = write output to file named like remote file
- `-u` = --user

### dirb: Web Content Scanner
- old and slow!
- `dirb http://example.com/`

### dirbuster
- ...

### dig
```
dig @server example.com [DNS record type]
dig example.com mx
dig axfr @NS example.com (Exp: @NS = @ns1112.ui-dns.org)
dig axfr @nsztm1.digi.ninja zonetransfer.me (for educational purpose)
```

*Checkout: [Z_Networks/DNS](https://github.com/p-arrow/Red-Blue-Guide/blob/main/Z_Networks/DNS.md)*

### ffuf
- fast fuzzing U fool
- `ffuf -c -w /usr/share/wordlists/dirb/big.txt -u http://10.10.10.10/FUZZ`

### gobuster
```
- gobuster dir -u http://192.168.0.155/ -w /usr/share/wordlists/dirb/common.txt
- gobuster -m dns -t 100 -u google.com -w /usr/share/wordlists/metasploit/namelist.txt
```
- t = number of concurrent threads
- m = method
- q = quit
- o = output


### nikto
- `nikto -host example.com`

### whatweb
- ...

### wpscan
```
wpscan –url http://example.com –enumerate u (users)
wpscan --usernames 'wpusers' --passwords 'pass' --url http://sbva.local/blog/
```

### red_hawk
- All in one web scan tool
- `git clone https://github.com/Tuhinshubhra/RED_HAWK.git`
