*Registry: Low-Level Database in Windows*

# RedTeam

## Autorun Key Locations
- `HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Run`
- `HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Run`
- `HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\RunOnce`
- `HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\RunOnce`
- Run: Initializes values asynchronously when loading from Registry
- RunOnce: Initializes values in order when loading from Registry
- Attackers can gain persistence by hiding data in these keys
- Alternative persistence location: `HKLM\SYSTEM\CurrentControlSet\Services`


# BlueTeam

## Recently Used Files Location
- `HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\RunMRU`
- Preinstalled "Regedit" doesn't show last modification by default --> Use **regdump** instead 
- Malware can change file extensions of executables
- Checkout here:
   - `HKEY_CLASSES_ROOT` (HKCR)
   - `HKEY\SOFTWARE\Classes`
   - `HKCU\SOFTWARE\Classes`


## Best Practice
- Check Windows Task Scheduler (if attacker scheduled tasks)
- Check Crontab (Linux)
